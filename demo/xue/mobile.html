<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>这个圣诞，i不雪藏</title>
	<meta name="description" content="摩擦！摩擦！发现雪中的i">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="email=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0;">
    <link rel="stylesheet" type="text/css" href="./xue_files/common.css">
    <style type="text/css">

        #blessContent{
            height: 15.2%;
            width: 62%;
            top: 41.5%;
            left: 18%;

            position: absolute;
            font-size: 1em;
        }

        #blessFrom{
            height: 3.8%;
            width: 33%;
            top: 59%;
            left: 18%;

            position: absolute;
            font-size: 0.8em;
        }


        #submitBtn{
            height: 7.5%;
            width: 25%;
            top: 82%;
            left: 35%;

            position: absolute;
        }

        #mask1{
            padding: 0;
            position: absolute;

            top: 23%;
            left: 45%;
            width: 50%;
            height: 39.5%;
            z-index: 100;

            /*display: none;*/

            /*background: red;*/
        }

        #mask2{
            padding: 0;
            position: absolute;

            top: 54%;
            left: 20%;
            width: 51%;
            height: 44%;
            z-index: 100;

            /*display: none;*/

            /*background: #008000;*/

        }

        #mask3{
            padding: 0;
            position: absolute;

            top: 22%;
            left: 44%;
            width: 50%;
            height: 39.5%;
            z-index: 100;

            display: none;
            /*opacity: 0;*/
        }

        #mask4{
            padding: 0;
            position: absolute;

            top: 53%;
            left: 20%;
            width: 51%;
            height: 44%;
            z-index: 100;

            /*opacity: 0;*/
            display: none;
        }

/*
        #covermasks{
            z-index: 15;
        }
*/
        .opacity0{
            opacity: 0;
        }

        .opacity1{
            opacity: 1;
        }

        #text2{

            height: 100%;
            width: 100%;
            left:0;
            z-index: 900;
        }

        #title2{
            padding: 0;
            position: absolute;

            top: 35%;
            left: 0;
            width: 100%;
            /*height: 100%;*/
            z-index: 100;

            text-align: center;

            /*display: none;*/
            /*opacity: 0;*/
        }


        #title3{
            top:30%;
            width: 100%;
            position: absolute;
            left: 0;
            bottom: 10px;
            text-align: center;
        }

        #title3 img{
            width: 70%;
            margin: 0 auto;
        }

    </style>
</head>
<body style="zoom: 1;">
<div class="fm_stage" style="height: 636px;">
    <div class="fm_wrap">
        <section class="fm fm1 cur fm_mid" style="width: 1304px; height: 636px;">
            <div class="piece">
                <i class="snow1 style1" style="left:448.44px; top:-28.02px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
                <i class="snow1 style1" style="left:94.72px; top:-20.59px; -webkit-animation: snow 6s linear 1s infinite;"></i>
                <i class="snow1 style2" style="left:457.09px; top:-23.82px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow1 style1" style="left:316.11px; top:-26.73px; -webkit-animation: snow 5s linear 0.1s infinite;"></i>
                <i class="snow1 style3" style="left:348.04px; top:-20.08px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow1 style1" style="left:385.96px; top:-29.19px; -webkit-animation: snow 5s linear 3s infinite;"></i>
                <i class="snow2 style2" style="left:296.15px; top:-29.17px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:346.66px; top:-23.16px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style1" style="left:156.48px; top:-22.29px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style2" style="left:16.43px; top:-25.69px; -webkit-animation: snow 9s linear 1s infinite;"></i>
                <i class="snow2 style2" style="left:28.49px; top:-26.21px; -webkit-animation: snow 8s linear 1s infinite;"></i>
                <i class="snow2 style3" style="left:3.82px; top:-25.30px; -webkit-animation: snow 9s linear 2s infinite;"></i>
                <i class="snow2 style2" style="left:12.18px; top:-23.42px; -webkit-animation: snow 9s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:11.88px; top:-26.34px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:236.62px; top:-23.36px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style2" style="left:48.04px; top:-28.08px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style1" style="left:116.67px; top:-24.12px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:4.72px; top:-21.74px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:-194.31px; top:-26.23px; -webkit-animation: snow 8s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:32.37px; top:-27.36px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:-7.74px; top:-22.74px; -webkit-animation: snow 10s linear 5s infinite;"></i>
                <i class="snow3 style2" style="left:368.74px; top:-25.60px; -webkit-animation: snow 7s linear 1s infinite;"></i>
                <i class="snow3 style3" style="left:14.08px; top:-37.95px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow3 style1" style="left:126.24px; top:-23.34px; -webkit-animation: snow 7s linear 3s infinite;"></i>
                <i class="snow3 style3" style="left:312.02px; top:-32.79px; -webkit-animation: snow 6s linear 5s infinite;"></i>
                <i class="snow3 style3" style="left:177.39px; top:-32.00px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow3 style2" style="left:644.23px; top:-35.51px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style2" style="left:258.58px; top:-42.24px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style3" style="left:222.16px; top:-42.89px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
            </div>
            <img src="./xue_files/arrow-up.png" class="up_arrow">
        </section>
        <section class="fm fm2 cover fm_bottom" style="width: 1304px; height: 636px;">
            <img src="./xue_files/arrow-up.png" class="up_arrow">

            <div id="masks">
                <div id="mask1"><img src="./img/border1.png" width="100%" ></div>
                <div id="mask2"><img src="./img/border2.png" width="100%" ></div>
            </div>

            <div class="piece">
                <i class="snow1 style1" style="left:448.44px; top:-28.02px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
                <i class="snow1 style1" style="left:94.72px; top:-20.59px; -webkit-animation: snow 6s linear 1s infinite;"></i>
                <i class="snow1 style2" style="left:457.09px; top:-23.82px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow1 style1" style="left:316.11px; top:-26.73px; -webkit-animation: snow 5s linear 0.1s infinite;"></i>
                <i class="snow1 style3" style="left:348.04px; top:-20.08px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow1 style1" style="left:385.96px; top:-29.19px; -webkit-animation: snow 5s linear 3s infinite;"></i>
                <i class="snow2 style2" style="left:296.15px; top:-29.17px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:346.66px; top:-23.16px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style1" style="left:156.48px; top:-22.29px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style2" style="left:16.43px; top:-25.69px; -webkit-animation: snow 9s linear 1s infinite;"></i>
                <i class="snow2 style2" style="left:28.49px; top:-26.21px; -webkit-animation: snow 8s linear 1s infinite;"></i>
                <i class="snow2 style3" style="left:3.82px; top:-25.30px; -webkit-animation: snow 9s linear 2s infinite;"></i>
                <i class="snow2 style2" style="left:12.18px; top:-23.42px; -webkit-animation: snow 9s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:11.88px; top:-26.34px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:236.62px; top:-23.36px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style2" style="left:48.04px; top:-28.08px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style1" style="left:116.67px; top:-24.12px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:4.72px; top:-21.74px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:-194.31px; top:-26.23px; -webkit-animation: snow 8s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:32.37px; top:-27.36px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:-7.74px; top:-22.74px; -webkit-animation: snow 10s linear 5s infinite;"></i>
                <i class="snow3 style2" style="left:368.74px; top:-25.60px; -webkit-animation: snow 7s linear 1s infinite;"></i>
                <i class="snow3 style3" style="left:14.08px; top:-37.95px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow3 style1" style="left:126.24px; top:-23.34px; -webkit-animation: snow 7s linear 3s infinite;"></i>
                <i class="snow3 style3" style="left:312.02px; top:-32.79px; -webkit-animation: snow 6s linear 5s infinite;"></i>
                <i class="snow3 style3" style="left:177.39px; top:-32.00px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow3 style2" style="left:644.23px; top:-35.51px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style2" style="left:258.58px; top:-42.24px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style3" style="left:222.16px; top:-42.89px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
            </div>

        </section>

        <section class="fm fm3  " style="width: 1304px; height: 636px;">

            <div id="title3">
                <img src="./img/zf.png" >
            </div>

            <img src="./xue_files/arrow-up.png" class="up_arrow">
            <div class="piece">
                <i class="snow1 style1" style="left:448.44px; top:-28.02px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
                <i class="snow1 style1" style="left:94.72px; top:-20.59px; -webkit-animation: snow 6s linear 1s infinite;"></i>
                <i class="snow1 style2" style="left:457.09px; top:-23.82px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow1 style1" style="left:316.11px; top:-26.73px; -webkit-animation: snow 5s linear 0.1s infinite;"></i>
                <i class="snow1 style3" style="left:348.04px; top:-20.08px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow1 style1" style="left:385.96px; top:-29.19px; -webkit-animation: snow 5s linear 3s infinite;"></i>
                <i class="snow2 style2" style="left:296.15px; top:-29.17px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:346.66px; top:-23.16px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style1" style="left:156.48px; top:-22.29px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style2" style="left:16.43px; top:-25.69px; -webkit-animation: snow 9s linear 1s infinite;"></i>
                <i class="snow2 style2" style="left:28.49px; top:-26.21px; -webkit-animation: snow 8s linear 1s infinite;"></i>
                <i class="snow2 style3" style="left:3.82px; top:-25.30px; -webkit-animation: snow 9s linear 2s infinite;"></i>
                <i class="snow2 style2" style="left:12.18px; top:-23.42px; -webkit-animation: snow 9s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:11.88px; top:-26.34px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:236.62px; top:-23.36px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style2" style="left:48.04px; top:-28.08px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style1" style="left:116.67px; top:-24.12px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:4.72px; top:-21.74px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:-194.31px; top:-26.23px; -webkit-animation: snow 8s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:32.37px; top:-27.36px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:-7.74px; top:-22.74px; -webkit-animation: snow 10s linear 5s infinite;"></i>
                <i class="snow3 style2" style="left:368.74px; top:-25.60px; -webkit-animation: snow 7s linear 1s infinite;"></i>
                <i class="snow3 style3" style="left:14.08px; top:-37.95px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow3 style1" style="left:126.24px; top:-23.34px; -webkit-animation: snow 7s linear 3s infinite;"></i>
                <i class="snow3 style3" style="left:312.02px; top:-32.79px; -webkit-animation: snow 6s linear 5s infinite;"></i>
                <i class="snow3 style3" style="left:177.39px; top:-32.00px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow3 style2" style="left:644.23px; top:-35.51px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style2" style="left:258.58px; top:-42.24px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style3" style="left:222.16px; top:-42.89px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
            </div>
        </section>

        <section class="fm fm5" style="width: 1304px; height: 636px;">
<!--
            <div id="text5" class=" ">
                <div style="height: 50%"></div>
                <div style="text-align: center; height: 20%">
                    <form id="formbless" name="formbless" action="http://www.baidu.com" method="post">
                        <div id="bcontent">
                            <input id="blessContent" name="blessContent" value="" >
                        </div>
                        <div id="bfrom">
                            <input id="blessFrom" name="blessFrom" value="">
                        </div>
                        <div id="submitform">
                            <input id="submitBtn" name="submit" type="submit" value="" style="background: url(./images/send.png);background-size: 100% 100%;">
                        </div>
                    </form>
                </div>
                <div style=" "></div>
            </div>
-->

            <img src="./img/share_mask.png" width="100%" height="100%" class="share_mask" onclick="$('.share_mask').hide();">
            <!--修改部分-->
			<!--<span class="share_btn"></span>-->
			<div class="dword"><textarea id="word" maxlength="54"></textarea></div>
			<div class="dfrom"><input type="text" id="tfrom" maxlength="10"></div>
			<div class="dsend"><img id="tsend" src="./img/send.png"></div>
			<!--修改部分-->

            <!--
            <div class="boc_logo"><img src="./xue_files/boc.png" width="120"></div>
            -->

            <div class="piece">
                <i class="snow1 style1" style="left:448.44px; top:-28.02px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
                <i class="snow1 style1" style="left:94.72px; top:-20.59px; -webkit-animation: snow 6s linear 1s infinite;"></i>
                <i class="snow1 style2" style="left:457.09px; top:-23.82px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow1 style1" style="left:316.11px; top:-26.73px; -webkit-animation: snow 5s linear 0.1s infinite;"></i>
                <i class="snow1 style3" style="left:348.04px; top:-20.08px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow1 style1" style="left:385.96px; top:-29.19px; -webkit-animation: snow 5s linear 3s infinite;"></i>
                <i class="snow2 style2" style="left:296.15px; top:-29.17px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:346.66px; top:-23.16px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style1" style="left:156.48px; top:-22.29px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style2" style="left:16.43px; top:-25.69px; -webkit-animation: snow 9s linear 1s infinite;"></i>
                <i class="snow2 style2" style="left:28.49px; top:-26.21px; -webkit-animation: snow 8s linear 1s infinite;"></i>
                <i class="snow2 style3" style="left:3.82px; top:-25.30px; -webkit-animation: snow 9s linear 2s infinite;"></i>
                <i class="snow2 style2" style="left:12.18px; top:-23.42px; -webkit-animation: snow 9s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:11.88px; top:-26.34px; -webkit-animation: snow 10s linear 4s infinite;"></i>
                <i class="snow2 style3" style="left:236.62px; top:-23.36px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style2" style="left:48.04px; top:-28.08px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style1" style="left:116.67px; top:-24.12px; -webkit-animation: snow 10s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:4.72px; top:-21.74px; -webkit-animation: snow 9s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:-194.31px; top:-26.23px; -webkit-animation: snow 8s linear 5s infinite;"></i>
                <i class="snow2 style3" style="left:32.37px; top:-27.36px; -webkit-animation: snow 8s linear 3s infinite;"></i>
                <i class="snow2 style3" style="left:-7.74px; top:-22.74px; -webkit-animation: snow 10s linear 5s infinite;"></i>
                <i class="snow3 style2" style="left:368.74px; top:-25.60px; -webkit-animation: snow 7s linear 1s infinite;"></i>
                <i class="snow3 style3" style="left:14.08px; top:-37.95px; -webkit-animation: snow 6s linear 2s infinite;"></i>
                <i class="snow3 style1" style="left:126.24px; top:-23.34px; -webkit-animation: snow 7s linear 3s infinite;"></i>
                <i class="snow3 style3" style="left:312.02px; top:-32.79px; -webkit-animation: snow 6s linear 5s infinite;"></i>
                <i class="snow3 style3" style="left:177.39px; top:-32.00px; -webkit-animation: snow 5s linear 1s infinite;"></i>
                <i class="snow3 style2" style="left:644.23px; top:-35.51px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style2" style="left:258.58px; top:-42.24px; -webkit-animation: snow 5s linear 4s infinite;"></i>
                <i class="snow3 style3" style="left:222.16px; top:-42.89px; -webkit-animation: snow 6s linear 0.1s infinite;"></i>
            </div>
        </section>
    </div>
</div>
<div class="music on">&nbsp;</div>
<audio src="./img/music1.mp3" id="audio_player" loop="loop" autoplay="autoplay">HTML5 Audio is not supported</audio>


<div id="cover">
    <img src="./xue_files/hand.png" class="cover_hand">

    <div id="covermasks">

        <div id="title2">
            <img src="./img/text2.png" width="70%" style="margin: 0 auto;" >
        </div>

    </div>

    <canvas style="position: fixed; left: 50%; top: 0px; width: 1304px; margin-left: -652px; height: auto; z-index: 20; background-color: transparent;" width="988" height="636"></canvas>
</div>
<div id="flagDiv" style="display: none;">
    <input id="car1" type="hidden" value="">
    <input id="car2" type="hidden" value="">
</div>

<script src="./xue_files/zepto.js" type="text/javascript"></script>
<script type="text/javascript">
    var hasScratch = false;
    $(function() {
        var body_width = document.documentElement.clientWidth;
        var body_height = document.documentElement.clientHeight;
        var move_obj = $(".fm_wrap");
        var fm = move_obj.find(".fm");
        var fm_len = fm.length;
        var starPoint,nowPoint,moveSpace;
        var move_speed = 300; //翻转速度
        var min_move = 30; //翻转触发最小距离
        var angle = 90;
        var per = 0,per2;
        var cur_index;
        var change = function(obj,translateY,rotateX,time,opacity,bezier){
            var bezier = bezier ? bezier : "linear";
            obj.css({ '-webkit-transform':"translateY("+translateY+"%) rotateX("+rotateX+"deg)",'-webkit-transition':time+'ms '+bezier, 'transform':"translateY("+translateY+"%) rotateX("+rotateX+"deg)",'transition':time+'ms '+bezier,'opacity':opacity });
        }
        var touchevent = {
            mystar: function(e){
                starPoint = e.touches[0].pageY;
                cur_index = $(this).index();
                move_obj.children().removeClass("cur").eq(cur_index).addClass("cur");
            },
            mymove: function(e){
                e.stopPropagation();
                e.preventDefault();
                nowPoint = e.touches[0].pageY;
                moveSpace = nowPoint-starPoint;
                per = moveSpace/body_width;
                per2 = 1-Math.abs(per);
                if(moveSpace>0){ //鼠标往下滑
                    if(cur_index>0){
                        $(".fm_bottom").removeClass("fm_active");
                        $(".fm_top").addClass("fm_active");
                        change($(".fm_top"),-per2*100,angle*per2,0); //opacity变化: Math.abs(per)
                        $(".fm_mid").removeClass("fm_top").addClass("fm_bottom");
                        change($(".fm_mid"),per*100,-angle*per,0); //opacity变化: 1-Math.abs(per)
                    }
                }else if(cur_index<fm_len-1){ //鼠标往上滑
                    $(".fm_top").removeClass("fm_active");
                    $(".fm_bottom").addClass("fm_active");
                    change($(".fm_bottom"),per2*100,-angle*per2*4/5,0); //opacity变化: Math.abs(per)
                    $(".fm_mid").removeClass("fm_bottom").addClass("fm_top");
                    change($(".fm_mid"),per*100,-angle*per,0); //opacity变化: 1-Math.abs(per)
                }
            },
            myend: function(e){
                if(Math.abs(moveSpace)>min_move){ //进行翻转
                    if(moveSpace>0){ //鼠标往下滑
                        if(cur_index>0){
                            cur_index--;
                            change($(".fm_top"),0,0,move_speed);
                            change($(".fm_mid"),100,-angle,move_speed,1);
                        }
                    }else if(cur_index<fm_len-1){ //鼠标往上滑
                        cur_index++;
                        change($(".fm_bottom"),0,0,move_speed);
                        change($(".fm_mid"),-100,angle,move_speed,1);
                    }
                    //fm_mid,fm_top,fm_bottom重置
                    setTimeout(function(){
                        fm.removeClass("fm_mid").removeClass("fm_top").removeClass("fm_bottom").removeClass("fm_active");
                        fm.eq(cur_index).addClass("fm_mid");
                        if(cur_index<fm_len-1){ fm.eq(cur_index+1).addClass("fm_bottom"); }
                        if(cur_index>0){ fm.eq(cur_index-1).addClass("fm_top"); }
                        //添加动画开始标签
                        fm.removeClass("cur").find(".animated").removeClass("in");
                        fm.eq(cur_index).addClass("cur").find(".animated").addClass("in");
                        if(cur_index==1&&!hasScratch){
                            fm.eq(cur_index).removeClass("cover");
                            $("#cover").show();
                        }
                    },move_speed)
                }else{ //返回原位
                    if(moveSpace>0&&cur_index>0){ //鼠标往右滑
                        change($(".fm_top"),-100,-angle,move_speed/2);
                    }else if(cur_index<fm_len-1){ //鼠标往左滑
                        change($(".fm_bottom"),100,angle,move_speed/2);
                    }
                    change($(".fm_mid"),0,0,move_speed/2);
                }
                moveSpace = 0;
            }
        }
        $(document).ready(function() {
            fm.eq(0).addClass("fm_mid");
            fm.eq(1).addClass("fm_bottom");
            $(".fm").css("width",body_width);
            $(".fm_stage,.fm").css("height",body_height);
            fm.bind("touchstart", touchevent.mystar);
            fm.bind("touchmove", touchevent.mymove);
            fm.bind("touchend", touchevent.myend);
            <!--修改部分-->
            /*$(".share_btn").on("touchstart","",function(){
//                $(".share_tip").show();
                $(".share_mask").show();
            })*/
			<!--修改部分-->
            $(".music").on("touchstart","",function(){
                if(audio_player.paused){
                    audio_player.play(); $(".music").removeClass("off").addClass("on");
                }else{
                    audio_player.pause(); $(".music").removeClass("on").addClass("off");
                }
            });
        });
    });
</script>
<script src="./xue_files/Scratch.js" type="text/javascript"></script>
<script type="text/javascript">
    function flashcar(){
        alert("flashcar");
    }

    var scratch_callback = function(){
        $("#cover").addClass("hiding");
        setTimeout(function(){
//            $("#cover").remove();


//            $("#mask1").show();
//            $("#mask2").show();

            //TODO 闪动

//            setTimeout(function(){
//                $("#cover").remove();
//
//            },800)

        },800)
    }
    var _param = {
        obj: $('#cover')[0],
        cover: './img/cover.jpg',
        covertype: 'image',
        coverbg: null,
        covertxt: null,
        w: $(window).width(),
        h: $(window).height()
    }
    var scratch = new Scratch($('#cover')[0],_param.cover,_param.covertype,_param.coverbg,_param.covertxt,_param.w,_param.h,scratch_callback);
    scratch.init();

	<!--修改部分-->
    var dataForWeixin = {
        img     : "http://1.playp2p.sinaapp.com/bmw/share_img/share.jpg",
        linkurl : window.location.href,
        desc    : "这个圣诞，i不雪藏",
        title   : "您收到一份圣诞祝福"
   };
   <!--修改部分-->
    (function() {
        var onBridgeReady = function() {
            WeixinJSBridge.on('menu:share:timeline',
            function(argv) {
                WeixinJSBridge.invoke('shareTimeline', {
                    "img_url"    : dataForWeixin.img,
                    "img_width"  : "120",
                    "img_height" : "120",
                    "link"       : dataForWeixin.linkurl,
                    "desc"       : dataForWeixin.desc,
                    "title"      : dataForWeixin.title
                },function(res) {
                    if(res.err_msg == 'share_timeline:ok'){
                        try{
                            //分享后的执行代码
                            window.location.href="info.php"
                        } catch(e) {
                           // alert(e);
                        }
                    }
                });
            });
            WeixinJSBridge.on('menu:share:appmessage',
              function(argv) {
             // alert('朋友');
            WeixinJSBridge.invoke('sendAppMessage', {
              "img_url": dataForWeixin.img,
              "img_width": "120",
              "img_height": "120",
              "link": dataForWeixin.linkurl,
              "desc": dataForWeixin.desc,
              "title": dataForWeixin.title
            },
            function(res) { 
             if(res.err_msg == 'send_app_msg:confirm'){
                        try{
                            //分享后的执行代码
                            //window.location.href="info.php"
                        } catch(e) {
                           // alert(e);
                        }
                    }
            });
          });
        };
        if (document.addEventListener) {
            document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
        } else if (document.attachEvent) {
            document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
            document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
        } else {
            alert(3);
        }
    })();
	
	<!--修改部分-->
	//获取中文字符长度 
	String.prototype.GetValue= function(parm) {  
		var reg = new RegExp("(^|&)"+ parm +"=([^&]*)(&|$)");  
		var r = this.substr(this.indexOf("\?")+1).match(reg);  
		if (r!=null) return unescape(r[2]); return null;  
	} 
	function getStrLength(str)
	{
		var cArr = str.match(/[^\x00-\xff]/ig);
		return str.length + (cArr == null ? 0 : cArr.length);
	}
	String.prototype.trim = function () {
		return this.replace(/^\s*/, "").replace(/\s*$/, "");
	}
	var sub=function(str,n){ 
		var r=/[^\x00-\xff]/g; 
		if(str.replace(r,"mm").length<=n){return str;} 
		var m=Math.floor(n/2); 
		for(var i=m;i<str.length;i++){ 
			if(str.substr(0,i).replace(r,"mm").length>=n){ 
				return str.substr(0,i); 
			} 
		} 
		return str; 
	} 
	$(function(){
		var str1="";
		var str2="";
		var str3=""
		var temp,temp1;
		var tfrom="";
		var stamp="";
		$("#word").keyup(function(){
			var str=$(this).val().trim();
			$(this).val(str);
			if(getStrLength(str)>54){
				$("#tfrom").focus();
			}
			/*if(getStrLength(str)<=18){
				$(this).val(str);
			}else if(getStrLength(str)>18 && getStrLength(str)<=36){
				str1=sub(str,18);
				str2=str.split(str1);
				
			}else if(getStrLength(str)>36 && getStrLength(str)<=54){
				str1=sub(str,18);
				temp=str.split(str1);
				str2=sub(temp[1],18);
				temp1=temp[1].split(str2);
				str3=temp1[1];
			}else if(getStrLength(str)>54){
				str1=sub(str,18);
				temp=str.split(str1);
				str2=sub(temp[1],18);
				temp1=temp[1].split(str2);
				str3=sub(temp1,18);
			}*/
			
		});
		$("#word").blur(function(){
			var str=$(this).val().trim();
			if(getStrLength(str)<=18){
				$(this).val(str);
			}else if(getStrLength(str)>18 && getStrLength(str)<=36){
				str1=sub(str,18);
				str2=str.split(str1);
				
			}else if(getStrLength(str)>36 && getStrLength(str)<=54){
				str1=sub(str,18);
				temp=str.split(str1);
				str2=sub(temp[1],18);
				temp1=temp[1].split(str2);
				str3=temp1[1];
			}else if(getStrLength(str)>54){
				str1=sub(str,18);
				temp=str.split(str1);
				str2=sub(temp[1],18);
				temp1=temp[1].split(str2);
				str3=sub(temp1,18);
			}
			if(str1!=""){
				stamp=str1;
			}
			if(str2!=""){
				stamp=stamp+"|IO|"+str2;
			}
			if(str3!=""){
				stamp=stamp+"|IO|"+str3;
			}
		});
		/*$("#tfrom").keyup(function(){
			tfrom=$(this).val();
			if(getStrLength(tfrom)>12){
				tfrom=sub(tfrom,12);
				$(this).val(tfrom);
			}
		});*/
		
		
		var url=location.href;
		var pic_url = url.GetValue("pic_url");
		if(pic_url!=""){
			$("#title3 img").attr("src",pic_url);
		}
		$(".dsend").click(function(){
			var word=stamp;
			var from=$("#tfrom").val();
			//word="来自点点滴滴的祝福|IO|点亮你我的生命火花|IO|亲爱的朋友"
			//from="你的朋友";
			$(".share_mask").show();
			//$("#word").val("");
			//$("#tfrom").val("");
			//alert(from);
			getImage(word,from);
		});
	});
	function getImage(a,b){
                var data="content="+a+"&from="+b;
                console.log(data);
                $.ajax({
                    type: "POST",
                    dataType : "text",
                    url:  "/cms/cn/zh/insights/events/pool/xmas_ecard/2014/action/pt_action.jsp", //"<cms:link>/cn/zh/insights/events/pool/xmas_ecard/2014/action/send_friend_form_action.jsp</cms:link>",
                    data: data,
                    success: function(data, status, jqXHR){
						$("#word").val("");
						$("#tfrom").val("");
						dataForWeixin.linkurl=dataForWeixin.linkurl+"?pic_url=http://new3.xiniu3d.com/"+data;
						
                    },
					error:function(){
						$("#word").val("");
						$("#tfrom").val("");
					}
                });
            }
	<!--修改部分-->
</script>

<script type="application/javascript">
    $("#mask1").hide();
    $("#mask2").hide();
    $("#mask3").hide();
    $("#mask4").hide();

    $("#title2").click(function(){
        alert("#title2 click");
        $("#title2").hide();
    });

    $("title2").bind("touchmove",function(){
        $("#title2").hide();
    });

    $("title2").bind("touchstart",function(){
        $("#title2").hide();
    });
</script>

</body>
</html>